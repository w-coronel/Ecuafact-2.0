var Config=function(){var n,t=function(){n=new KTWizard("config_wizard",{startStep:1,clickableSteps:!0})},i=function(){$(".configure-form").validate({errorElement:"span",errorClass:"help-block",focusInvalid:!1,ignore:"",rules:{RUC:{required:!0,digits:!0,minlength:13},BussinesName:{required:!0},TradeName:{required:!0},MainAddress:{required:!0},Phone:{required:!0,digits:!0},Email:{required:!0,email:!0},EnvironmentType:{required:!0},IssueType:{required:!0},EstablishmentCode:{required:!0},IssuePointCode:{required:!0}},messages:{RUC:{required:"Debe especificar un número de RUC ",digits:"Debe especificar solo Números",minlength:"Debe contener un número autorizado por el SRI de 13 dígitos"},BussinesName:{required:"Debe especificar la Razon Social",onlyLetters:"Debe especificar solo letras"},TradeName:{required:"Debe especificar el Nombre Comercial",onlyLetters:"Debe especificar solo letras"},MainAddress:{required:"Debe especificar una dirección válida"},Phone:{required:"Debe especificar un número de telefono",digits:"Debe ingresar un número de telefono válido"},Email:{required:"Debe especificar un Correo Electrónico",email:"Debe ingresar un Correo Electrónico válido"},EnvironmentType:{required:"Debe especificar el tipo de Ambiente que va a utilizar"},IssueType:{required:"Debe especificar el tipo de emisión"},EstablishmentCode:{required:"Debe especificar un código de Establecimiento"},IssuePointCode:{required:"Debe especificar un código de emisión"}},invalidHandler:function(){},highlight:function(n){$(n).closest(".form-group").addClass("has-error")},success:function(n){n.closest(".form-group").removeClass("has-error");n.remove()},submitHandler:function(n){n.submit()}});$(".configure-form input").keypress(function(n){if(n.which==13)return $(".button-submit").is(":visible")&&$(".configure-form").validate().form()&&$(".configure-form").submit(),!1});$("#configForm .button-submit").click(function(){return $(".configure-form").validate().form()&&$(".configure-form").submit(),!1}).hide();$(".configure-form").submit(function(n){return $(".configure-form").validate().valid()?(showLoader(),!0):(toastr.error("Debe completar con la informacion del Emisor!"),n.preventDefault(),!1)});$(".budget-limits").submit(function(n){n.preventDefault()});$(".solicitud-esign").on("click",r);$(".delete-item").on("click",u);$(".limits-value").on("change",function(){var i=$(this),t=i.val()*1,r,u,n,s,h;t<0&&(t=0);r=i.prop("name").replace("maxValue","total");u=$("[name='"+r+"']");setValueSafe(u,(t*12).toFixed(2));i.val(t.toFixed(2));var f=$("input.limits-value"),c=$("input.limits-total"),e=0,o=0;for(n=0;n<f.length;n++)s=$(f[n]).val()*1,h=$(c[n]).val()*1,e+=s,o+=h;setValueSafe($("[name='limits.total_mensual']"),e.toFixed(2));setValueSafe($("[name='limits.total_anual']"),o.toFixed(2))});$(".save-budget").on("click",function(){var n=$(".budget-limits"),t=n.prop("action"),i=n.serializeArray();showLoader();$.ajax({url:t,type:"POST",data:i,async:!0,error:function(n){if(console.log(n),n&&n.responseText&&n.responseText.includes("login")){Swal.fire("Su Sesion ha Caducado","Por favor inicie sesion","error");var t=open(location.origin,"_top","height=770,width=520")}else toastr.error(n.statusText)},success:function(n){n.IsSuccess?toastr.success(n.UserMessage):toastr.error(n.UserMessage||"Hubo un error al guardar")}}).always(function(){hideLoader()});return});$.fn.DataTable&&$(".datatable").DataTable({responsive:!0,pageLength:5,lengthMenu:[5,10,25,50],searching:!1});var n=new KTAvatar("kt_user_edit_avatar");f()},r=function(){var n=$(this),i=parseInt(n.data("options").option),t=n.data("options").valor;switch(i){case 1:Swal.fire("Información",t,"info");break;case 2:Swal.fire("Información",t,"info");n.data("options",{option:3,valor:Config.plansUrl});n[0].innerText="SOLICITAR PLAN";break;default:showLoader();location.assign(t)}},u=function(){var n=$(this),t=n.data("ruc"),i=Config.urlDesvincular+"/"+t;Swal.fire({title:"Cuenta",text:"¿Esta usted seguro de desvincular la cuenta?",icon:"info",type:"warning",showCancelButton:!0,cancelButtonText:"Cancelar",confirmButtonText:"Eliminar"}).then(function(t){t.value&&(showLoader(),$.ajax({url:i,type:"post",async:!0,cache:!1,error:function(n){console.log(n);toastr.error("No se pudo desvincular la cuenta!")},success:function(t){t.id>0?(toastr.success(t.message),n.parents("tr").remove()):toastr.success(t.message)}}).always(function(){hideLoader()}))})},f=function(){var n=$("#configForm"),t=$(".alert-danger",n),i=$(".alert-success",n),r=function(n,t,i){var u=t.find("li").length,f=i+1,e,r;for($(".step-title",$("#configForm")).text("Paso "+(i+1)+" de "+u),jQuery("li",$("#configForm")).removeClass("done"),e=t.find("li"),r=0;r<i;r++)jQuery(e[r]).addClass("done");f==1?$("#configForm").find(".button-previous").hide():$("#configForm").find(".button-previous").show();f>=u?($("#configForm").find(".button-next").hide(),$("#configForm").find(".button-submit").show()):($("#configForm").find(".button-next").show(),$("#configForm").find(".button-submit").hide());App.scrollTo($(".page-title"))}};return{plansUrl:"",urlDesvincular:"",Init:function(){t();i()}}}();